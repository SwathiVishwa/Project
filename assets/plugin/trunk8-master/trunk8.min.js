!function(d,c){"function"==typeof define&&define.amd?define(["jquery"],c):c("object"==typeof module&&module.exports?require("jquery"):d.jQuery)}(this,function(e){function s(b){this.$element=e(b),this.original_text=e.trim(this.$element.html()),this.settings=e.extend({},e.fn.trunk8.defaults)}function t(b){var c=document.createElement("DIV");return c.innerHTML=b,"undefined"!=typeof c.textContent?c.textContent:c.innerText}function h(g){if(t(g)===g){return g.split(/\s/g)}for(var c,f,j=[],b=/<([a-z]+)([^<]*)(?:>([\S\s]*?(?!<\1>))<\/\1>|\s+\/>)(['.?!,]*)|((?:[^<>\s])+['.?!,]*\w?|<br\s?\/?>)/gi,d=b.exec(g);d&&c!==b.lastIndex;){c=b.lastIndex,d[5]?j.push(d[5]):d[1]&&j.push({tag:d[1],attribs:d[2],content:d[3],after:d[4]}),d=b.exec(g)}for(f=0;f<j.length;f++){"string"!=typeof j[f]&&j[f].content&&(j[f].content=h(j[f].content))}return j}function o(c,b,d){c=c.replace(d,"");var f=function(q,j){var z,y,p,k,m="";for(k=0;k<q.length;k++){z=q[k],p=e.trim(c).split(" ").length,e.trim(c).length&&("string"==typeof z?(/<br\s*\/?>/i.test(z)||(1===p&&e.trim(c).length<=z.length?(z=c,("p"===j||"div"===j)&&(z+=d),c=""):c=c.replace(z,"")),m+=e.trim(z)+(k===q.length-1||1>=p?"":" ")):(y=f(z.content,z.tag),z.after&&(c=c.replace(z.after,"")),y&&(z.after||(z.after=" "),m+="<"+z.tag+z.attribs+">"+y+"</"+z.tag+">"+z.after)))}return m},g=f(b);return g.slice(g.length-d.length)!==d&&(g+=d),g}function l(){var q,c,I,b,y,J,g=this.data("trunk8"),j=g.settings,k=j.width,w=j.side,m=j.fill,f=j.parseHTML,d=n.getLineHeight(this)*j.lines,p=g.original_text,u=p.length,v="";if(this.html(p),y=this.text(),f&&t(p)!==p&&(J=h(p),p=t(p),u=p.length),k===a.auto){if(this.height()<=d){return}for(q=0,c=u-1;c>=q;){I=q+(c-q>>1),b=n.eatStr(p,w,u-I,m),f&&J&&(b=o(b,J,m)),this.html(b),this.height()>d?c=I-1:(q=I+1,v=v.length>b.length?v:b)}this.html(""),this.html(v),j.tooltip&&this.attr("title",y)}else{if(isNaN(k)){return void e.error('Invalid width "'+k+'".')}I=u-k,b=n.eatStr(p,w,I,m),this.html(b),j.tooltip&&this.attr("title",p)}j.onTruncate()}var i,n,r={center:"center",left:"left",right:"right"},a={auto:"auto"};s.prototype.updateSettings=function(b){this.settings=e.extend(this.settings,b)},i={init:function(b){return this.each(function(){var d=e(this),c=d.data("trunk8");c||d.data("trunk8",c=new s(this)),c.updateSettings(b),l.call(d)})},update:function(b){return this.each(function(){var c=e(this);b&&(c.data("trunk8").original_text=b),l.call(c)})},revert:function(){return this.each(function(){var b=e(this).data("trunk8").original_text;e(this).html(b)})},getSettings:function(){return e(this.get(0)).data("trunk8").settings}},n={eatStr:function(b,f,m,d){var j,c,k=b.length,g=n.eatStr.generateKey.apply(null,arguments);if(n.eatStr.cache[g]){return n.eatStr.cache[g]}if(("string"!=typeof b||0===k)&&e.error('Invalid source string "'+b+'".'),0>m||m>k){e.error('Invalid bite size "'+m+'".')}else{if(0===m){return b}}switch("string"!=typeof(d+"")&&e.error("Fill unable to be converted to a string."),f){case r.right:return n.eatStr.cache[g]=e.trim(b.substr(0,k-m))+d;case r.left:return n.eatStr.cache[g]=d+e.trim(b.substr(m));case r.center:return j=k>>1,c=m>>1,n.eatStr.cache[g]=e.trim(n.eatStr(b.substr(0,k-j),r.right,m-c,""))+d+e.trim(n.eatStr(b.substr(k-j),r.left,c,""));default:e.error('Invalid side "'+f+'".')}},getLineHeight:function(g){var c=e(g).css("float");"none"!==c&&e(g).css("float","none");var d=e(g).css("position");"absolute"===d&&e(g).css("position","static");var b,j=e(g).html(),f="line-height-test";return e(g).html("i").wrap('<div id="'+f+'" />'),b=e("#"+f).innerHeight(),e(g).html(j).css({"float":c,position:d}).unwrap(),b}},n.eatStr.cache={},n.eatStr.generateKey=function(){return Array.prototype.join.call(arguments,"")},e.fn.trunk8=function(b){return i[b]?i[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?void e.error("Method "+b+" does not exist on jQuery.trunk8"):i.init.apply(this,arguments)},e.fn.trunk8.defaults={fill:"&hellip;",lines:1,side:r.right,tooltip:!0,width:a.auto,parseHTML:!1,onTruncate:function(){}}});