!function(t,e){"function"==typeof define&&define.amd?define(["jquery"],e):e("object"==typeof module&&module.exports?require("jquery"):t.jQuery)}(this,function(t){function o(e){this.$element=t(e),this.original_text=t.trim(this.$element.html()),this.settings=t.extend({},t.fn.trunk8.defaults)}function r(t){var e=document.createElement("DIV");return e.innerHTML=t,"undefined"!=typeof e.textContent?e.textContent:e.innerText}function a(t){if(r(t)===t)return t.split(/\s/g);for(var s,o,e=[],i=/<([a-z]+)([^<]*)(?:>([\S\s]*?(?!<\1>))<\/\1>|\s+\/>)(['.?!,]*)|((?:[^<>\s])+['.?!,]*\w?|<br\s?\/?>)/gi,n=i.exec(t);n&&s!==i.lastIndex;)s=i.lastIndex,n[5]?e.push(n[5]):n[1]&&e.push({tag:n[1],attribs:n[2],content:n[3],after:n[4]}),n=i.exec(t);for(o=0;o<e.length;o++)"string"!=typeof e[o]&&e[o].content&&(e[o].content=a(e[o].content));return e}function l(e,i,n){e=e.replace(n,"");var s=function(i,o){var a,l,h,d,r="";for(d=0;d<i.length;d++)a=i[d],h=t.trim(e).split(" ").length,t.trim(e).length&&("string"==typeof a?(/<br\s*\/?>/i.test(a)||(1===h&&t.trim(e).length<=a.length?(a=e,("p"===o||"div"===o)&&(a+=n),e=""):e=e.replace(a,"")),r+=t.trim(a)+(d===i.length-1||1>=h?"":" ")):(l=s(a.content,a.tag),a.after&&(e=e.replace(a.after,"")),l&&(a.after||(a.after=" "),r+="<"+a.tag+a.attribs+">"+l+"</"+a.tag+">"+a.after)));return r},o=s(i);return o.slice(o.length-n.length)!==n&&(o+=n),o}function h(){var g,m,b,y,w,$,e=this.data("trunk8"),n=e.settings,o=n.width,h=n.side,f=n.fill,d=n.parseHTML,c=i.getLineHeight(this)*n.lines,p=e.original_text,u=p.length,v="";if(this.html(p),w=this.text(),d&&r(p)!==p&&($=a(p),p=r(p),u=p.length),o===s.auto){if(this.height()<=c)return;for(g=0,m=u-1;m>=g;)b=g+(m-g>>1),y=i.eatStr(p,h,u-b,f),d&&$&&(y=l(y,$,f)),this.html(y),this.height()>c?m=b-1:(g=b+1,v=v.length>y.length?v:y);this.html(""),this.html(v),n.tooltip&&this.attr("title",w)}else{if(isNaN(o))return void t.error('Invalid width "'+o+'".');b=u-o,y=i.eatStr(p,h,b,f),this.html(y),n.tooltip&&this.attr("title",p)}n.onTruncate()}var e,i,n={center:"center",left:"left",right:"right"},s={auto:"auto"};o.prototype.updateSettings=function(e){this.settings=t.extend(this.settings,e)},e={init:function(e){return this.each(function(){var i=t(this),n=i.data("trunk8");n||i.data("trunk8",n=new o(this)),n.updateSettings(e),h.call(i)})},update:function(e){return this.each(function(){var i=t(this);e&&(i.data("trunk8").original_text=e),h.call(i)})},revert:function(){return this.each(function(){var e=t(this).data("trunk8").original_text;t(this).html(e)})},getSettings:function(){return t(this.get(0)).data("trunk8").settings}},i={eatStr:function(e,s,o,r){var h,f,a=e.length,l=i.eatStr.generateKey.apply(null,arguments);if(i.eatStr.cache[l])return i.eatStr.cache[l];if(("string"!=typeof e||0===a)&&t.error('Invalid source string "'+e+'".'),0>o||o>a)t.error('Invalid bite size "'+o+'".');else if(0===o)return e;switch("string"!=typeof(r+"")&&t.error("Fill unable to be converted to a string."),s){case n.right:return i.eatStr.cache[l]=t.trim(e.substr(0,a-o))+r;case n.left:return i.eatStr.cache[l]=r+t.trim(e.substr(o));case n.center:return h=a>>1,f=o>>1,i.eatStr.cache[l]=t.trim(i.eatStr(e.substr(0,a-h),n.right,o-f,""))+r+t.trim(i.eatStr(e.substr(a-h),n.left,f,""));default:t.error('Invalid side "'+s+'".')}},getLineHeight:function(e){var i=t(e).css("float");"none"!==i&&t(e).css("float","none");var n=t(e).css("position");"absolute"===n&&t(e).css("position","static");var r,s=t(e).html(),o="line-height-test";return t(e).html("i").wrap('<div id="'+o+'" />'),r=t("#"+o).innerHeight(),t(e).html(s).css({"float":i,position:n}).unwrap(),r}},i.eatStr.cache={},i.eatStr.generateKey=function(){return Array.prototype.join.call(arguments,"")},t.fn.trunk8=function(i){return e[i]?e[i].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof i&&i?void t.error("Method "+i+" does not exist on jQuery.trunk8"):e.init.apply(this,arguments)},t.fn.trunk8.defaults={fill:"&hellip;",lines:1,side:n.right,tooltip:!0,width:s.auto,parseHTML:!1,onTruncate:function(){}}});